<html>
   <head>
      <title>OneMap: Original Map (XYZ)</title>
      <link rel="stylesheet" href="https://www.onemap.gov.sg/web-assets/libs/leaflet/leaflet.css" />
      <script src="https://www.onemap.gov.sg/web-assets/libs/leaflet/onemap-leaflet.js"></script>
   </head>

   <body>
      <h1>Original Map (XYZ)</h1>
      <div id='mapdiv' style='height:800px;'></div>
      <script>
         let sw = L.latLng(1.144, 103.535);
         let ne = L.latLng(1.494, 104.502);
         let bounds = L.latLngBounds(sw, ne);

         let map = L.map('mapdiv', {
            center: L.latLng(1.2868108, 103.8545349),
            zoom: 16
         });

         map.setMaxBounds(bounds);

         let basemap = L.tileLayer('https://www.onemap.gov.sg/maps/tiles/Original/{z}/{x}/{y}.png', {
            detectRetina: true,
            maxZoom: 19,
            minZoom: 11,
            /** DO NOT REMOVE the OneMap attribution below **/
            attribution: '<img src="https://www.onemap.gov.sg/web-assets/images/logo/om_logo.png" style="height:20px;width:20px;"/>&nbsp;<a href="https://www.onemap.gov.sg/" target="_blank" rel="noopener noreferrer">OneMap</a>&nbsp;&copy;&nbsp;contributors&nbsp;&#124;&nbsp;<a href="https://www.sla.gov.sg/" target="_blank" rel="noopener noreferrer">Singapore Land Authority</a>'
         });

         basemap.addTo(map);

               // 2. Fetch data from published Google Sheet (replace with your actual link)
      fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vRkEkPfP_J2kJNPu6hFRhe_qaRJ2EGIHMm1ILWXqXxbGpx9hRHOeATDtX_-VngJcbHk6bvl_J_b6AzZ/pub?output=csv")
        .then(response => response.text())
        .then(data => {
          const rows = data.split("\n").slice(1); // skip header row
          rows.forEach(row => {
            const cols = row.split(",");
            const lat = parseFloat(cols[9]); // Latitude (Column C)
            const lng = parseFloat(cols[10]); // Longitude (Column D)
            const address = cols[5];         // Address (Column B)
            const crime = cols[3] || "Unknown"; // Crime type (Column E)

            if (!isNaN(lat) && !isNaN(lng)) {
              L.marker([lat, lng])
                .addTo(map)
                .bindPopup(`<b>${address}</b><br>Crime: ${crime}`);
            }
          });
        });
      </script>
   </body>
</html>
